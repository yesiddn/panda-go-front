<div class="flex flex-col min-h-screen my-8">
  <section class="w-full max-w-[1200px] mx-auto">
    <div class="hero flex justify-center flex-col max-w-[1200px] min-h-64 mx-auto px-8 py-6 rounded-2xl">
      <div class="flex items-center justify-between">
        <div>
          <h2 class="text-2xl font-bold text-white">{{ routeData?.route_code }}</h2>
          <div class="text-white">{{ routeData?.route_date | date:'fullDate' }}</div>
        </div>
        <div class="text-right">
          <div class="text-white"><strong>Estado:</strong> {{ routeData?.status === 'in_progress' ? 'In Progress' : routeData?.status === 'planned' ? 'Planned' : 'Completed' }}</div>
          <div class="text-white"><strong>Paradas:</strong> {{ routeData?.capacity_stops }}</div>
        </div>
      </div>
      <div class="flex items-center justify-between mt-4 text-white">
        <div>
          <div><strong>Inicio:</strong> {{ routeData?.start_time }} — <strong>Fin:</strong> {{ routeData?.end_time }}
          </div>
          <div class="mt-2"><strong>Notas:</strong> {{ routeData?.notes || '—' }}</div>
        </div>
        @if (routeData?.status === 'planned') {
          <div class="">
            <p-button label="Iniciar ruta" [rounded]="true" severity="success" (click)="startRoute()"></p-button>
          </div>
        }
        @if (routeData?.status === 'in_progress') {
          <div class="">
            <p-button label="Completar ruta" [rounded]="true" severity="success" (click)="completeRoute()"></p-button>
          </div>
        }
      </div>
    </div>

    @if (requests.length > 0) {
    <div class="space-y-4 mt-8">
      <h3 class="text-xl font-bold mb-4">Solicitudes en esta ruta</h3>

      @for (collectionRequest of requests; track $index) {
      <div class="flex gap-4 items-center max-w-[1200px] mx-auto p-4 space-y-4 rounded-xl bg-white/10 shadow-lg ring-1 ring-black/5">
        <div class="w-12 h-12 m-0 rounded-lg bg-[#ebf0ed] flex items-center justify-center">
          <img src="/icons/leaf.svg" alt="organic" class="w-6 h-6" />
        </div>
        <div class="flex-1 m-0">
          <div class="text-[#121714] text-[16px] font-bold">{{ collectionRequest.user.first_name }} {{ collectionRequest.user.last_name }}</div>
          <div class="text-[#618575] text-[14px]">
            {{ collectionRequest.address_snapshot }} · {{ collectionRequest.waste_category.name }}
          </div>
        </div>
        @if (routeData?.status === 'in_progress') {
          <a routerLink="/app/routes/request/{{ collectionRequest.id }}" pButton [rounded]="true" severity="success">
            <span pButtonLabel>Recolectar</span>
          </a>
        }
      </div>
      }
    </div>
    }
    @else {
    <div class="rounded-xl p-8 flex flex-col items-center justify-center text-center">
      <img src="/icons/taken.svg" alt="no requests" class="w-36 h-36 mb-6" />
      <h3 class="text-[#121714] text-lg font-bold mb-2">No hay solicitudes en esta ruta</h3>
      <p class="text-[#618575]">Esta ruta todavía no tiene solicitudes asignadas.</p>
    </div>
    }
  </section>
</div>
